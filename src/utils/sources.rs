use std::collections::HashMap;

fn get_bbbike_source(city_name: &String) -> (&str, &str) {
    let base_url = "https://download.bbbike.org/osm/bbbike";
    let suffix = ".osm.pbf";
    let cities = [
        "Aachen",
        "Aarhus",
        "Adelaide",
        "Albuquerque",
        "Alexandria",
        "Amsterdam",
        "Antwerpen",
        "Arnhem",
        "Auckland",
        "Augsburg",
        "Austin",
        "Baghdad",
        "Baku",
        "Balaton",
        "Bamberg",
        "Bangkok",
        "Barcelona",
        "Basel",
        "Beijing",
        "Beirut",
        "Berkeley",
        "Berlin",
        "Bern",
        "Bielefeld",
        "Birmingham",
        "Bochum",
        "Bogota",
        "Bombay",
        "Bonn",
        "Bordeaux",
        "Boulder",
        "BrandenburgHavel",
        "Braunschweig",
        "Bremen",
        "Bremerhaven",
        "Brisbane",
        "Bristol",
        "Brno",
        "Bruegge",
        "Bruessel",
        "Budapest",
        "BuenosAires",
        "Cairo",
        "Calgary",
        "Cambridge",
        "CambridgeMa",
        "Canberra",
        "CapeTown",
        "Chemnitz",
        "Chicago",
        "ClermontFerrand",
        "Colmar",
        "Copenhagen",
        "Cork",
        "Corsica",
        "Corvallis",
        "Cottbus",
        "Cracow",
        "CraterLake",
        "Curitiba",
        "Cusco",
        "Dallas",
        "Darmstadt",
        "Davis",
        "DenHaag",
        "Denver",
        "Dessau",
        "Dortmund",
        "Dresden",
        "Dublin",
        "Duesseldorf",
        "Duisburg",
        "Edinburgh",
        "Eindhoven",
        "Emden",
        "Erfurt",
        "Erlangen",
        "Eugene",
        "Flensburg",
        "FortCollins",
        "Frankfurt",
        "FrankfurtOder",
        "Freiburg",
        "Gdansk",
        "Genf",
        "Gent",
        "Gera",
        "Glasgow",
        "Gliwice",
        "Goerlitz",
        "Goeteborg",
        "Goettingen",
        "Graz",
        "Groningen",
        "Halifax",
        "Halle",
        "Hamburg",
        "Hamm",
        "Hannover",
        "Heilbronn",
        "Helsinki",
        "Hertogenbosch",
        "Huntsville",
        "Innsbruck",
        "Istanbul",
        "Jena",
        "Jerusalem",
        "Johannesburg",
        "Kaiserslautern",
        "Karlsruhe",
        "Kassel",
        "Katowice",
        "Kaunas",
        "Kiel",
        "Kiew",
        "Koblenz",
        "Koeln",
        "Konstanz",
        "LaPaz",
        "LaPlata",
        "LakeGarda",
        "Lausanne",
        "Leeds",
        "Leipzig",
        "Lima",
        "Linz",
        "Lisbon",
        "Liverpool",
        "Ljubljana",
        "Lodz",
        "London",
        "Luebeck",
        "Luxemburg",
        "Lyon",
        "Maastricht",
        "Madison",
        "Madrid",
        "Magdeburg",
        "Mainz",
        "Malmoe",
        "Manchester",
        "Mannheim",
        "Marseille",
        "Melbourne",
        "Memphis",
        "MexicoCity",
        "Miami",
        "Moenchengladbach",
        "Montevideo",
        "Montpellier",
        "Montreal",
        "Moscow",
        "Muenchen",
        "Muenster",
        "NewDelhi",
        "NewOrleans",
        "NewYorkCity",
        "Nuernberg",
        "Oldenburg",
        "Oranienburg",
        "Orlando",
        "Oslo",
        "Osnabrueck",
        "Ostrava",
        "Ottawa",
        "Paderborn",
        "Palma",
        "PaloAlto",
        "Paris",
        "Perth",
        "Philadelphia",
        "PhnomPenh",
        "Portland",
        "PortlandME",
        "Porto",
        "PortoAlegre",
        "Potsdam",
        "Poznan",
        "Prag",
        "Providence",
        "Regensburg",
        "Riga",
        "RiodeJaneiro",
        "Rostock",
        "Rotterdam",
        "Ruegen",
        "Saarbruecken",
        "Sacramento",
        "Saigon",
        "Salzburg",
        "SanFrancisco",
        "SanJose",
        "SanktPetersburg",
        "SantaBarbara",
        "SantaCruz",
        "Santiago",
        "Sarajewo",
        "Schwerin",
        "Seattle",
        "Seoul",
        "Sheffield",
        "Singapore",
        "Sofia",
        "Stockholm",
        "Stockton",
        "Strassburg",
        "Stuttgart",
        "Sucre",
        "Sydney",
        "Szczecin",
        "Tallinn",
        "Tehran",
        "Tilburg",
        "Tokyo",
        "Toronto",
        "Toulouse",
        "Trondheim",
        "Tucson",
        "Turin",
        "UlanBator",
        "Ulm",
        "Usedom",
        "Utrecht",
        "Vancouver",
        "Victoria",
        "WarenMueritz",
        "Warsaw",
        "WashingtonDC",
        "Waterloo",
        "Wien",
        "Wroclaw",
        "Wuerzburg",
        "Wuppertal",
        "Zagreb",
        "Zuerich",
    ];
    let lookup_map = HashMap::new();
    for city in cities {
        match city {
            "NewYorkCity" => lookup_map.insert(
                city.to_lowercase(),
                (
                    city.to_lowercase() + suffix,
                    format!("{base_url}/NewYork/NewYork{suffix}"),
                ),
            ),
            _ => lookup_map.insert(
                city.to_lowercase(),
                (
                    city.to_lowercase() + suffix,
                    format!("{base_url}/{city}/{city}{suffix}"),
                ),
            ),
        };
    };
    match lookup_map.get(&city_name.to_lowercase()) {
        Some((filename, url)) => (filename, url),
        None => Err(format!("{city_name} not available")),
    }
}

#[test]
fn test_for_existing_city() {
    let existing_city = "Zuerich";
    assert_eq!(
        get_bbbike_source(&existing_city.into()),
        (
            "zuerich.osm.pbf",
            "https://download.bbbike.org/osm/bbbike/Zuerich/Zuerich.osm.pbf"
        )
    );
}

#[test]
fn test_for_nonexistant_city() {
    let nonexistant_city = "Hogwarts";
    let result = get_bbbike_source(&nonexistant_city.into()).map_err();
    assert_eq!(result, Error);
}

#[test]
fn test_for_newyorkcity() {
    let existing_city = "NewYorkCity";
    assert_eq!(
        get_bbbike_source(&existing_city.into()),
        (
            "newyorkcity.osm.pbf",
            "https://download.bbbike.org/osm/bbbike/NewYork/NewYork.osm.pbf"
        )
    );
}
